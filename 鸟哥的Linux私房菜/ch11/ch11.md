## Bash 基本功能

- 通过 **type** 命令，可以知道每个命令是否为 bash 的内置命令
  ```bash
  >$ type cd
  cd is a shell builtin
  >$ type ll
  ll is aliased to `ls -alF'
  ```
  - **type** 也可以用来作为类似 which 命令的用途
- `\[Enter]` 也就是在一行结束时，以 `\` 结束可以继续在下一行填写命令
- 变量的显示：`echo $variable` 或是 `echo ${variable}`，例如 `echo $PATH`
- 变量的设置规则
  - 变量与变量内容以一个等号 “=” 来连接，例如
    - myname=VBird
  - 变量内容若有空格符可使用双引号或单引号将变量内容结合起来
    - 双引号内的特殊字符可保留原有的特性
    - 单引号内的特殊字符仅为一般字符
  - 可用转义字符 `\` 将特殊符号变成一般字符
  - 在一串命令中，还需要通过其他的命令提供的信息，可以使用反单引号或 “$(命令)”，例如
    ```bash
    >$ version=$(uname -r)
    >$ echo $version
    4.15.0-210-generic
    ```
  - 若该变量为了增加变量内容时，则可用 `"$变量"` 或 `${变量}` 累加内容，例如
    ```bash
    >$ PATH="$PATH":/home/bin
    ```
  - 若该变量需要在其他子进程（在当前 shell 中另打开的 shell）执行，则需要以 export 来使变量变成环境变量
  - 通常大写字符为系统默认变量，自行设置变量可以使用小写字符
  - 取消变量的方法为使用 "unset 变量名称" (仅仅能取消当前 shell 下的变量)
- 环境变量的功能
  - 用 `env` 查看环境变量与常见环境变量说明
  - 用 `set` 查看所有变量 (环境变量+bash相关变量+用户自定义变量)
  - `$` 本身也是一个变量，指代的是目前这个 shell 的线程代号，即 PID
  - `?` 指代的是上一个执行的命令所回传的值（一般来说，命令执行成功回传 0，执行错误，则回传错误代码）
  - `export` 将自定义变量转换成环境变量（子进程仅仅会继承父进程的环境变量）
- 历史命令 `history`
  ```bash
  >$ history 4                    # 列出最近执行的 4 条指令
  >$ history -w                   # 立刻将目前的数据写入 histfile 中（~/.bash_history）
  >$ !!                           # 执行上一个命令
  >$ !n                           # 执行第 n 个命令
  ```

## Bash Shell 的操作环境

- 命令的运行顺序
  1. 以相对/绝对路径执行命令，例如 `/bin/ls` 或 `./ls`
  2. 由 `alias` 找到该命令来执行
  3. 由 bash 内置的（builtin）命令来执行
  4. 通过 $PATH 这个变量的顺序找到的第一个命令来执行
- login 与 non-login shell
  - login shell：取得 bash 时需要完整的登录流程
  - non-login shell：取得 bash 接口不需要重复登录的举动
  - `/etc/profile` 是系统整体的设置，login shell 才会读，每个用户登录取得 bash 时一定会读取的配置文件，可帮所有用户设定整体的环境变量。bash 的 login shell 情况下所读取的整体环境配置文件其实只有 `/etc/profile`
  - `~/.bash_profile` 在 login shell 才会读，它是个人偏好配置文件，login shell 的 bash 中，所读取的顺序（按从上到下的顺序读取，**只会读取其中一个**）
    - `~/.bash_profile`
    - `~/.bash_login`
    - `~/.profile`
  - `~/.bashrc` 在 non-login shell 会读，有的操作系统会调用 `/etc/bashrc`
- 利用 `source` 或是 `.` 都可以将配置文件的内容读进目前的 shell 环境中
- `.bash_logout` 记录了注销 bash 后系统的操作
- 终端机的环境设置
  - 利用 `stty` 帮助设置终端机的输入按键代表意义


## 数据流重定向

- 数据流重定向就是将某个命令执行后应该要出现在屏幕上的数据传输到其他的地方
  ![](./Screen%20Shot%202023-06-18%20at%204.04.48%20PM.png)
- 标准输入（stdin）：代码为 0，使用 < (覆盖) 或 << (条件终止)
- 标准输入（stdout）：代码为 1，使用 > (覆盖) 或 >> (累加)
- 标准错误输出（stderr）：代码为 2，使用 2> (覆盖) 或 2>> (累加)
- 输出范例：
  ```bash
  # 将 stdout 与 stderr 分别存到不同的文件中去
  >$ find /home -name .bashrc > list_right 2> list_error
  # 将 stderr 丢弃，屏幕上显示正确的数据
  >$ find /home -name .bashrc 2> /dev/null
  # 将命令的数据全部写入名为 list 的文件中
  >$ find /home -name .bashrc > list 2> list  # 错误，可能交叉写入造成次序的错误
  >$ find /home -name .bashrc > list 2>&1     # 正确
  >$ find /home -name .bashrc &> list         # 正确
  ```
- `<` 与 `<<` 表示的是将原本需要由键盘输入的数据改由文件内容来替代，范例
  ```bash
  # 复制 ~/.bashrc 到 catfile
  >$ cat > catfile < ~/.bashrc
  ```

