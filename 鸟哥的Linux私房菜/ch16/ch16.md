## 仅执行一次的工作调度

### atd 与 at

- `atd` 的启动
  ```bash
  >$ /etc/init.d/atd restart
  ```
- `at` 的运行方式
  1. 先寻找 `/etc/at.allow` 这个文件，写在这个文件中的用户才能使用 `at`，没有在这个文件中的用户不能使用 `at` (即使没有写在 `/etc/at.deny` 当中)
  2. 如果 `/etc/at.allow` 不存在，就寻找 `/etc/at.deny` 这个文件，若写在这个文件中的用户则不能使用 `at`，没有在这个文件中的用户可以使用
  3. 如果两个文件都不存在，那么只有 root 可以使用 `at` 这个命令
- `at` 的使用例子
  ```bash
  >$ at now + 5 minutes
  at> /bin/mail root -s "testing at job" < /root/.bashrc
  at> <EOT>     # <== 这里输入 [ctrl] + d 就会出现 <EOT>

  >$ at 23:00 2023-07-03
  at> /bin/sync
  at> /bin/sync
  at> /sbin/shutdown -h now
  at> <EOT>
  ```
- `at` 工作的管理
  ```bash
  >$ atq                   # 查询目前主机上面有多少的 at 工作调度
  >$ atrm [jobnumber]      # 删除工作
  ```
- `batch`: 系统有空时才进行后台任务
  - 利用 `at` 来进行命令的执行，只是加入一些控制参数而已
  - 它会在 CPU 工作负载小于 0.8 的时候，才进行你所执行的工作任务
  - `batch` 命令的使用方式与 `at` 相同
  - `batch` 也是使用 `atq/atrm` 来管理的

