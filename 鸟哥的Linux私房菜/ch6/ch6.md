## Linux 的文件权限和目录配置

### 用户与用户组

- 每个账号都可以有多个用户组支持
- 任何一个文件都具有 `User`、`Group`、`Others` 三种身份的权限
- 默认情况下，所有的系统上的账号与一般身份用户，root 的相关信息，都是记录在 **`/etc/passwd`** 文件内
- 个人的密码记录在 **`/etc/shadow`** 文件内
- 所有的组名都记录在 **`/etc/group`** 文件内

### 文件权限概念

- `chgrp`: 改变文件的所属用户组
  - 要修改的组名必须在 `/etc/group` 中存在，否则会提示出错
- `chown`: 改变文件所有者
  - 要修改的用户必须在 `/etc/group` 中存在，否则会提示出错
  - 也能修改所属用户组，eg. `>$ chown root:root install.log`
- `chmod`: 改变文件的权限
  - 数字类型改变文件权限 -> **r:4, w:2, x:1**
  - 符号类型改变文件权限 -> 
    |     |     |     |     |     |
    | --- | --- | --- | --- | --- | 
    |       | u | + (加入) | r |          |
    | chmod | g | - (去除) | w | 文件或目录 |
    |       | o | = (设置) | x |          |
    |       | a |         |   |          |
  - 在 `+` 和 `-` 状态下，只要是没有指定到的选项，该权限是不会变动的

### 目录与权限的意义

#### 文件

- 在 Linux 下面，我们的文件能否被执行是由是否具有 `x` 这个权限来定，跟文件名无关
- 当你对一个文件具有 `w` 的权限时，就具有写入、编辑、新增、修改文件内容的权限，**但是并不具备删除该文件本身的权限**
- `r,w,x` 都针对的是文件内容，与文件名的存在与否没有关系

#### 目录

- `r`: 读取目录结构列表的权限
- `w`: 与该目录下文件名变动有关
- `x`: 代表的是用户能否 `cd` 进入该目录称为工作目录
- 要开放目录给任何人浏览时，应该至少要给予 `r` 及 `x` 的权限，但 `w` 权限不可随便给

### 目录配置

- Filesystem Hierarchy Standard (FHS) 标准规范了每个特定目录下应该放置什么样的数据
  |  | shareable | unshareable |
  | --- | --- | --- |
  | static | `/usr`, `/opt`  | `/etc`, `/boot` |
  | variable | `/var/mail`, `/var/spool/news` | `/var/run`, `/var/lock` |

- **FHS** 定义了 `/` 目录下最好要有的字目录
  | 目录 | 文件内容 |
  | --- | --- |
  | `/bin` | 一般用户可用，启动时会用到的命令  |
  | `/boot` | Linux 内核文件，以及开机菜单与开机所需要的文件 |
  | `/dev` | 任何设备与设备接口都是以文件的形式存在于这个目录下 |
  | `/etc` | 主要的系统配置文件，FHS 建议不要放置可执行文件到这个目录下 |
  | `/usr` | UNIX software resource，与软件安装与执行有关 |
  | `/var` | 与系统运作过程有关 |
  | `/home` | 默认的用户主文件夹 |
  | `/lib` | 系统函数库，包括开机，以及 `/bin` 或 `/sbin` 下面命令会调用的函数库 |
  | `/media` | 放置的是可删除的设备 |
  | `/mnt` | 用途与 `/media` 类似，用作暂时挂载用 |
  | `/opt` | 给第三方软件放置的目录 |
  | `/root` | 系统管理员的主文件夹 |
  | `/sbin` | 开机或单用户模式时还能操作的命令 |
  | `/srv` | 网络服务所提供的数据 |
  | `/tmp` | 一般用户或者是正在执行的程序暂时放置文件的地方 |
  | `/lost+found` | 目的在于当文件系统发生错误时，将一些丢失的片段放置到这个目录下 |
  | `/proc` | 本身是一个虚拟文件系统，这个目录下放置的都是内存数据，不占任何硬盘空间 |
  | `/sys` | 类似 `/proc` |

- `/usr` 的具体内容
  - 所有系统默认的软件（distribution 发布者提供的软件）都会放置到 `/usr` 下面
  - `/usr` 的字目录建议：
    | 目录 | 文件内容 |
    | --- | --- |
    | `/usr/bin` | 绝大部分用户可以使用的命令，与 `bin` 的不同在于是否与开机过程有关  |
    | `/usr/include` | 头文件与包含文件 |
    | `/usr/lib` | 函数库、目标文件（object file）、以及不被一般用户惯用的执行文件或脚本 |
    | `/usr/local` | 系统管理员在本机自行安装自己下载的软件（非 distribution 默认提供） |
    | `/usr/sbin` | 非系统正常运行所需要的系统命令 |
    | `/usr/share` | 放置共享文件、文档的地方 |
    | `/usr/src` | 一般源码建议放置此处 |
