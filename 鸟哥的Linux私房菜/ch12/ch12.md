## grep 的一些高级参数及用法

```bash
# -n 表示找到的结果加上行号显示
# -A 后接数字，表示的是 after，意思是除了列出该行外，后续的 n 行也列出来
# -B 后接数字，表示的是 before，意思是除了列出该行外，前面的 n 行也列出来
>$ dmesg | grep -n -A3 -B2 'eth'

# -i 表示忽略大小写
>$ grep -in 'the' regular_express.txt

# -v 表示反向选择，命令表示过滤掉空白行，以及开头是 # 的行
>$ grep -v '^$' /etc/syslog.conf | grep -v '^#'

# 因为 {} 符号在 shell 中是有特殊意义的，因此这里必须使用转义字符
>$ grep -n 'o\{2\}' regular_express.txt

# 找出 /etc 下面文件类型为连接文件属性的文件名
>$ ls -l /etc | grep '^l'
```

## sed 工具

用法：
```bash
>$ sed [-nefr] [动作]
参数
-n：安静模式，只有经过 sed 处理过的那一行才会被列出来
-e：直接在命令行模式上进行 sed 的动作编辑
-f：将 sed 的动作写在一个文件内
-r：表示的是 sed 动作支持的是扩展型正则表达式的语法（默认是基础正则表达式语法）
-i：直接修改读取的文件内容，而不是由屏幕输出

动作说明：
[n1[,n2]]function
function 有下列操作：
a：新增
c：替换（字符串替换行）
d：删除
i：插入
p：打印
s：替换（字符串替换），格式：'s/要被替换的字符串/新的字符串/g'
```

例子：
```bash
# 以行为单位进行删除操作
>$ nl /etc/passwd | sed '2,5d'

# 在第二行后面添加字符串
>$ nl /etc/passwd | sed '2a drinking'

# 在第二行前面添加字符串
>$ nl /etc/passwd | sed '2i drinking'

# 在第二行后面添加两行字符串（多行可以用 \ 来进行增加）
>$ nl /etc/passwd | sed '2a drinking \
water'

# 把 2 到 5 行的内容替换为 No 2-5 number
>$ nl /etc/passwd | sed '2,5c No 2-5 number'

# 仅列出 /etc/passwd 文件中的 2 到 5 行（需在安静模式下执行）
>$ nl /etc/passwd | sed -n '2,5p'

# 在 /etc/manpath.config 中找出 MAN 所在行
# 将注释删除（#后面的内容）
# 删除空白行
>$ cat /etc/manpath.config | grep 'MAN' | sed 's/#.*$//g' | sed '/^$/d'

# 将 regular_express.txt 内的每一行中的 . 替换成 !
>$ sed -i 's/\.$/\!/g' regular_express.txt
```

